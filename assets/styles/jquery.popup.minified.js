!function(t){t.popup=new function(){this.initialize=function(){this.popups={},this.z_index=9001,this.options={},this.ios=["iPad","iPhone","iPod"].indexOf(navigator.platform)>=0,this.mobile=void 0!==window.orientation||-1!==navigator.userAgent.indexOf("IEMobile"),this.options.reload=!1,this.options.template=null,this.options.loading="<div>Loading...</div>",this.options.background=!0,this.options.background_close=!0,this.options.center=null,this.options.center_open=!1,this.options.center_once=!1,this.options.width=null,this.options.height=null,this.options.left="0px",this.options.top="0px",this.options.transform=null},this.create=function(i,o){if(o=t.extend({},this.options,o||{}),i=i.replace(/^\#/,""),null!=this.popups[i])throw'Popup id "'+i+'" already exists.';var s=new function(i,o,s){this.initialize=function(i,o,s){if(this.owner=i,this.id=o,this.options=s||{},this.url=null,this.parameters=null,this.object=null,this.parent=null,this.background_object=null,this.template=null,this.loading=null,this.loaded=!1,this.opened=!1,this.ajax=null,this.drag={},this.parent=s.parent&&t(s.parent)||t("body"),1==this.options.modal&&null==this.options.center&&(this.options.center=!0),1==this.options.modal&&null==this.options.background&&(this.options.background=!0),this.template=t(this.options.template).first(),this.template.length>0?this.template.css("display","none"):this.template=null,this.loading=t(this.options.loading).first(),this.loading.length>0?this.loading.css("display","none"):this.loading=null,this.background(this.options.background,{parent:this.options.background_parent,close:this.options.background_close,opacity:this.options.background_opacity}),o=o.replace(/^\#/,""),this.object=t("#"+o).first(),this.object.length>0){if(this.object.detach(),null!=this.template){this.object.removeClass("popup_window");var n=this.object.html();this.object.html(this.template.html()),this.object.find(".popup_content").html(n)}this.object.addClass("popup_window")}else this.object=t("<div class='popup_window'></div>"),this.object.attr("id",o);return this.object.css("display","none"),this.object.css("z-index",0),this.object.css("position","absolute"),this.object.css("pointer-events","auto"),this.parent.append(this.object),this},this.open=function(i){if(1!=this.opened)return this.opened=!0,i=t.extend({},this.owner.options,this.options,i),1!=this.loaded||null!=this.ajax||1==i.reload?(null!=i.url?this.load(i.url,i.parameters):null!=i.content?(this.content(i.content),i.content=null):(this.init(),this.bind()),this.loaded=!0):(this.init(),this.bind()),this.object.trigger("open",[this]),this},this.close=function(){if(1==this.opened)return this.opened=!1,this.unbind(),this.object.css("display","none"),null!=this.background_object&&this.background_object.css("display","none"),this.object.trigger("close",[this]),this},this.toggle=function(t){1!=this.opened?this.open(t):this.close()},this.focus=function(){return this.owner.focus(this.id)},this.init=function(){return this.object.css("width",this.options.width||"auto"),this.object.css("height",this.options.height||"auto"),1==this.options.center||1==this.options.center_open||1==this.options.center_once?(this.center(),this.options.center_once=!1):(this.object.css("left",this.options.left),this.object.css("top",this.options.top),this.object.css("transform",this.options.transform||this.object.css("transform"))),null!=this.background_object&&(this.background_object.css("width","100%"),this.background_object.css("height","100%"),this.background_object.css("top","0%"),this.background_object.css("left","0%"),this.background_object.css("position","fixed"),this.background_object.css("display","block")),this.object.css("display","block"),this.focus(),this},this.load=function(i,o){o=o||{},this.url=i,this.parameters=o,null!=this.template?this.object.html(this.template.html()):this.object.html("<div class='popup_content'></div>"),null!=this.loading&&(this.object.find(".popup_content").html("<div class='popup_loading'></div>"),this.object.find(".popup_loading").html(this.loading.html()),this.object.data("loading",!0),this.init(),this.bind());var s=this.ajax;null!=s&&s.abort();var n=this,e=this.owner;return this.ajax=t.ajax({url:i,data:o,success:function(i){e.ready_queue=[],n.object.find(".popup_content").html(i),n.ajax=null,n.init(),n.bind(),t.each(e.ready_queue,function(t,i){i(n)})},error:function(t,i,o){"abort"!=t.statusText&&(n.object.find(".popup_content").html("<div class='popup_error'></div><div align='center'><button class='popup_close'>Close</button></div>"),n.object.find(".popup_error").html("Error: "+t.status+" "+t.statusText),n.init(),n.bind())}}),null!=this.loading&&(this.init(),this.bind()),this},this.reload=function(){return this.load(this.url,this.parameters)},this.content=function(t){return null==t?this.object.html():(null!=this.template?this.object.html(this.template.html()):this.object.html("<div class='popup_content'></div>"),this.object.find(".popup_content").html(t),this.init(),this.bind(),t)},this.background=function(i,o){var s=(o=o||{}).parent&&t(o.parent)||this.parent||t("body"),n=1==o.close,e=o.opacity||.333;return 1==i?((i=t("<div class='popup_background'></div>")).css("background-color","#000"),i.css("opacity",e)):"number"==typeof i?(e=i,(i=t("<div class='popup_background'></div>")).css("background-color","#000"),i.css("opacity",e)):null!=i&&(i=t(i).first()).detach(),null!=i&&(i.attr("id",this.id+"_background"),i.css("display","none"),i.css("z-index",0),i.css("position","absolute"),i.css("pointer-events","auto"),null!=o.opacity&&i.css("opacity",e),1==n&&i.addClass("popup_close"),s.append(i)),null!=this.background_object&&this.background_object.css("display","none"),this.background_object=i,1==this.opened&&(this.init(),this.bind()),i},this.center=function(){var i,o,s,n,e=t(window).scrollTop(),c=t(window).scrollLeft(),p=t(window).height(),h=t(window).width(),u=t(document).height(),r=t(document).width(),l=this.object.outerHeight(!0),a=this.object.outerWidth(!0),d=this.object.position().top,b=this.object.position().left,f=1;return 1==this.owner.ios&&(f=document.documentElement.clientWidth/window.innerWidth),this.object.css("left",0),this.object.css("top",0),l<=p/f?i=e+(p/f-l)/2:(o=(i=d)+l,i>e?i=e:o<e+p/f&&(i=e+p/f-l)),a<=h/f?s=c+(h/f-a)/2:(n=(s=b)+a,s>c?s=c:n<c+h/f&&(s=c+h/f-a)),"auto"==this.width&&s+a>h&&(s=h-a),this.object.css("top",i<0?0:i),this.object.css("left",s<0?0:s),t(document).height()>u&&(i-=t(document).height()-u,this.object.css("top",i<0?0:i)),t(document).width()>r&&(s-=t(document).width()-r,this.object.css("left",s<0?0:s)),this},this.bind=function(){return this.object.bind("mousedown",{self:this},this.focus_click),this.object.find(".popup_close").bind("click",{self:this},this.close_click),t(this.background_object).hasClass("popup_close")&&this.background_object.bind("click",{self:this},this.close_click),this.object.find(".popup_drag").css("cursor","move"),this.object.find(".popup_drag").bind("mousedown",{self:this},this.drag_mouse_down),this.object.bind("DOMNodeInserted DOMNodeRemoved",{self:this},this.center_event),this},this.unbind=function(){return this.object.unbind("mousedown",this.focus_click),this.object.find(".popup_close").unbind("click",this.close_click),null!=this.background_object&&this.background_object.unbind("click",this.close_click),this.object.find(".popup_drag").unbind("mousedown",this.drag_mouse_down),this.object.unbind("DOMNodeInserted DOMNodeRemoved",this.center_event),this},this.focus_click=function(t){return t.data.self.focus()},this.close_click=function(t){return t.data.self.close()},this.drag_mouse_down=function(t){var i=t.data.self;1!=i.options.center&&(position=i.object.position(),i.drag.x=position.left,i.drag.y=position.top,i.drag.x_offset=t.pageX,i.drag.y_offset=t.pageY,i.parent.mousemove({self:i},i.drag_mouse_move),i.parent.mouseup({self:i},i.drag_mouse_up))},this.drag_mouse_move=function(t){var i=t.data.self;x=t.pageX,y=t.pageY,x=i.drag.x-(i.drag.x_offset-x),y=i.drag.y-(i.drag.y_offset-y),i.object.css("left",x+"px"),i.object.css("top",y+"px"),i.options.left=x+"px",i.options.top=y+"px"},this.drag_mouse_up=function(t){var i=t.data.self;i.parent.unbind("mousemove",i.drag_mouse_move),i.parent.unbind("mouseup",i.drag_mouse_up)},this.center_event=function(t){var i=t.data.self;1==i.options.center&&i.center()},this.initialize(i,o,s)}(this,i,o);return this.popups[i]=s,this.popups[i]},this.destroy=function(t,i){t=t.replace(/^\#/,"");var o=this.popups[t];if(null==o)throw'Popup id "'+t+'" not found.';return o.close(),o.object.remove(),null!=o.background_object&&i[!1]&&o.background_object.remove(),this.popups[t]=null,t},this.get=function(t){return t=t.replace(/^\#/,""),this.popups[t]},this.open=function(t,i){t=t.replace(/^\#/,"");var o=this.popups[t];if(null==o)throw'Popup id "'+t+'" not found.';return o.open(i)},this.close=function(t){t=t.replace(/^\#/,"");var i=this.popups[t];if(null==i)throw'Popup id "'+t+'" not found.';return i.close()},this.toggle=function(t,i){t=t.replace(/^\#/,"");var o=popups[t];if(null==o)throw'Popup id "'+t+'" not found.';return o.toggle(i)},this.focus=function(t){t=t.replace(/^\#/,"");var i=this.popups[t];if(null!=i){var o=i.options["background_z-index"]||i.options.background_z_index,s=i.options["z-index"]||i.options.z_index;return null==o&&(o=s),null==o&&(o=++this.z_index),null==s&&(s=++this.z_index),null!=i.background_object&&i.background_object.css("z-index",o),i.object.css("z-index",s),i}},this.focused=function(){var i=null,o=0;return t.each(this.popups,function(t,s){var n=parseInt(s.object.css("z-index"));s.opened&&n>o&&(o=n,i=s)}),i},this.ready_queue=[],this.ready=function(t){this.ready_queue.push(t)},this.current=function(i){return null==i&&(i=this),i=t(i).closest(".popup_window"),this.popups[i.attr("id")]},this.template=function(t){return null==t?this.options.template:this.options.template=t},this.loading=function(t){return null==t?this.options.loading:this.options.loading=t},this.background=function(i,o){return o=o||{},this.options.background_parent=o.parent&&t(o.parent),this.options.background_close=o.close,this.options.background_opacity=o.opacity,this.options.background=i},this.options=function(t,i){t=t.replace(/^\#/,"");var o=this.popups[t];return null==o?{}:o.options},this.extend_options=function(i){return i=i||{},t.extend(this.options,i)},t(window).bind("scroll resize",function(){var i=t.popup.popups;t.each(i,function(t,i){1==i.opened&&1==i.options.center&&i.center()})}),this.initialize()},t.fn.popup=function(){return t.popup.current(this)}}(jQuery),$(document).on("ready change DOMNodeInserted",function(){$("input, textarea").on("focus",function(){if(1==$.popup.mobile){var t=$.popup.current(this);null!=t&&1==t.options.center&&(t.options.center="input")}}),$("input, textarea").on("blur",function(){if(1==$.popup.mobile){var t=$.popup.current(this);null!=t&&("input"==t.options.center&&(t.options.center=!0),t.center())}})});
