{% extends 'base.html.twig' %}

{% block body %}
<style>
    .product-container {
        margin: 20px;
    }

    .product-content {
        display: flex;
        flex-wrap: wrap;
        align-items: stretch;
    }

    .product-image {
        flex: 1;
        max-width: 500px;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
    }

    .product-image img {
        max-width: 100%;
        height: auto;
    }

    .product-details {
        flex: 2;
        margin-left: 20px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        /* Center content vertically */
        height: 100%;
        /* Ensure it takes the full height */
    }

    .product-details .ui.segment {
        min-height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        /* Center content vertically within the segment */
    }

    .product-details h1 {
        margin-bottom: 10px;
    }

    .product-details p {
        margin-bottom: 15px;
    }

    .add-to-cart-btn {
        margin-top: 20px;
    }
</style>
<div class="ui container">


    <div class="separator">{% include "alertflash/flash_message.html.twig" %}</div>

    {% if formAddService is defined %}

    <div class="ui container">
        <div class="ui segment">

            {# formulaire d'ajout d'un nouveau service #}


            {{ form_start(formAddService, {'attr': {'class': 'ui form service'}}) }}
            <h1 class="uk-animation-slide-right">{{ title_page }}
                {# <span>
                    {% if service|default and service.title is not null %}
                    {{ service.title }}
                    {% endif %}
                </span> #}
            </h1>

            <div class="field">
                {{ form_label(formAddService.course.theme) }}
                {{ form_widget(formAddService.course.theme) }}
                {{ form_errors(formAddService.course.theme) }}
            </div>
            <div class="field">
                {{ form_label(formAddService.course.category) }}
                {{ form_widget(formAddService.course.category) }}
                {{ form_errors(formAddService.course.category) }}
            </div>
            <div class="field">
                {{ form_label(formAddService.course.course) }}
                {{ form_widget(formAddService.course.course) }}
                {{ form_errors(formAddService.course.course) }}
            </div>
            <hr>
            {# Prévisualisation de l'image existante #}
            {% if service.picture|default %}
            <div class="field ">
                <img id="imagePreview" src="{% if pictureUrl|default %} {{ asset(pictureUrl) }} {% endif %}"
                    alt="Image Preview profile user" />
            </div>
            {% endif %}

            <div class="field">
                {{ form_label(formAddService.picture) }}
                {{ form_widget(formAddService.picture, {'attr': {'onchange': 'previewImage(event)'}}) }}
                {{ form_errors(formAddService.picture) }}
            </div>
            <div class="field">
                {{ form_label(formAddService.title) }}
                {{ form_widget(formAddService.title) }}
                {{ form_errors(formAddService.title) }}
            </div>
            <div class="field">
                {{ form_label(formAddService.description) }}
                {{ form_widget(formAddService.description) }}
                {{ form_errors(formAddService.description) }}
            </div>
            <div class="field">
                {{ form_label(formAddService.price) }}
                {{ form_widget(formAddService.price) }}
                {{ form_errors(formAddService.price) }}
            </div>
            <div class="field">
                {{ form_label(formAddService.duration) }}
                {{ form_widget(formAddService.duration) }}
                {{ form_errors(formAddService.duration) }}
            </div>
            <div class="field">
                {{ form_row(formAddService.submit) }}
            </div>
            {{ form_end(formAddService) }}

        </div>
    </div>

    {% endif %}

    {# Liste des services #}
    {% if services|default %}
    <div class="ui list">
        {% for service in services %}
        <div class="item">
            <i class="folder icon"></i>
            <div class="content">
                <div class="header"> <a href="{{ path('detail_service', { 'id': service.id }) }}">{{ service.title}}</a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}


    {# Détail d'un service #}
    {% if service|default %}
    <div class="ui container product-container">
        <div class="ui two column stackable grid">
            <div class="column">
                <div class="ui segment equal-height">
                    <div class="product-image">
                        <img src="{{ asset(service.picture) }}" alt="Product Image" class="ui fluid image">
                    </div>
                </div>
            </div>
            <div class="column">
                <div class="ui segment equal-height">
                    <div class="product-details">
                        <h1 class="ui header">{{ service.title }}</h1>
                        <p><strong>Description: </strong>{{ service.description }}</p>
                        <p><strong>Prix: </strong>{{ service.price }}€</p>
                        <p><strong>Catégories: </strong>{{ service.course.nameCourse }}</p>
                        <p><strong>Créé le: </strong>{{ service.createDate|date('d/m/Y') }}</p>
                        <p><strong>Réf: </strong>{{ service.id }}</p>
                        <a href="{{ path('add_service_cart', {'id': service.id}) }}" class="ui primary button add-to-cart-btn">Ajouter au panier</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    {# si l'utilisateur est connecter #}
    {% if app.user %}
    {# On s'assure que l'user est l'auteur du service #}
    {% if service.user.id == app.user.id %}
    {# <a href="" class="ui button primary">
        Suprimer un service
    </a> #}
    {% endif %}
    {% endif %}

    {% endif %}
    {% block javascripts %}
    {{ parent() }}
    {# On a besoin de ces scripts uniquement si nous créons ou éditons un Service #}
    {% if formAddService is defined %}
    {# On inject le script pour la gestion des contenus dynamique des select #}
    {{ encore_entry_script_tags('ViewServiceForm') }}
    {# On inject le script pour la prévisualisation de l'image avant upload (enregistrement) #}
    {{ encore_entry_script_tags('previewImage') }}
    {% endif %}
    {% endblock %}
</div>
{% endblock %}